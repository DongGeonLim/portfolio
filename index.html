<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>작가 임동건 | 포트폴리오</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-dark: #121212; 
            --btn-gray: #2a2a2a; 
            --cube-size: 128px; 
            --half-size: 64px;
            --indicator-dot: rgba(255, 255, 255, 0.2);
            --indicator-active: rgba(255, 255, 255, 0.9);
        }

        body, html {
            margin: 0; padding: 0;
            width: 100vw; height: 100vh;
            overflow: hidden; 
            background-color: var(--bg-dark);
            font-family: 'Pretendard', sans-serif;
        }

        .container {
            display: flex;
            width: 100vw; height: 100vh;
            overflow-x: hidden; 
            overflow-y: hidden;
            scroll-snap-type: x mandatory; 
            /* scroll-behavior: smooth; -> JS에서 동적으로 제어하기 위해 기본값은 제거 권장 */
            -ms-overflow-style: none;
            scrollbar-width: none;
            cursor: grab;
            user-select: none;
        }
        .container:active { cursor: grabbing; }
        .container::-webkit-scrollbar { display: none; }

        .page {
            width: 100vw; height: 100vh;
            flex-shrink: 0; 
            scroll-snap-align: start;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .page-indicator {
            position: fixed;
            bottom: 35px;
            left: 50%;
            transform: translateX(-50%);
            display: grid;
            grid-template-columns: repeat(4, 12px);
            grid-template-rows: repeat(3, 12px);
            gap: 8px;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .page-indicator.active { opacity: 1; }

        .dot {
            width: 8px;
            height: 8px;
            background-color: var(--indicator-dot);
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .dot.top    { grid-column: 2; grid-row: 1; opacity: 0.1; } 
        .dot.page0  { grid-column: 1; grid-row: 2; } 
        .dot.page1  { grid-column: 2; grid-row: 2; } 
        .dot.page2  { grid-column: 3; grid-row: 2; } 
        .dot.extra  { grid-column: 4; grid-row: 2; opacity: 0.1; } 
        .dot.bottom { grid-column: 2; grid-row: 3; opacity: 0.1; } 

        .dot.active {
            background-color: var(--indicator-active);
            box-shadow: 0 0 8px var(--indicator-active);
        }

        .hero { 
            text-align: center; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            gap: 70px; 
            color: white; 
            margin-top: -10px;
        }
        .title-area h1 { font-size: 2.5rem; margin: 0; font-weight: 700; }
        .title-area p { color: #888; margin: 10px 0 25px; font-size: 1rem; }

        .social-group { display: flex; gap: 15px; justify-content: center; z-index: 100; }
        .social-btn {
            width: 50px; height: 50px; background-color: var(--btn-gray);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            text-decoration: none; color: white; font-size: 1.4rem; transition: all 0.3s ease;
        }

        .scene { 
            width: var(--cube-size); height: var(--cube-size); 
            perspective: 1200px; cursor: grab; overflow: visible; 
        }

        .cube {
            width: 100%; height: 100%; position: relative;
            transform-style: preserve-3d;
            transform: rotateX(-15deg) rotateY(-25deg);
            transition: transform 0.6s ease-in-out;
        }

        .cube.dragging { transition: none !important; }

        .face {
            position: absolute; width: var(--cube-size); height: var(--cube-size);
            display: flex; align-items: center; justify-content: center;
            font-size: 12px; font-weight: bold; color: white;
            border: 1px solid rgba(255,255,255,0.1);
            backface-visibility: visible;
            transition: transform 0.6s ease-in-out;
        }

        .face span {
            font-size: 2rem;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .cube.unfolded .face span {
            opacity: 1;
        }

        .front  { background: #000080; transform: rotateY(0deg) translateZ(var(--half-size)); }
        .back   { background: #4A8FD7; transform: rotateY(180deg) translateZ(var(--half-size)); }
        .right  { background: #9D4EDD; transform: rotateY(90deg) translateZ(var(--half-size)); }
        .left   { background: #7B1B7E; transform: rotateY(-90deg) translateZ(var(--half-size)); }
        .top    { background: #F5A347; transform: rotateX(90deg) translateZ(var(--half-size)); }
        .bottom { background: #8BAD2B; transform: rotateX(-90deg) translateZ(var(--half-size)); }

        .cube.unfolded .front  { transform: rotateY(0deg) translateZ(0); }
        .cube.unfolded .left   { transform: rotateY(0deg) translateX(calc(var(--cube-size) * -1)); }
        .cube.unfolded .right  { transform: rotateY(0deg) translateX(var(--cube-size)); }
        .cube.unfolded .back   { transform: rotateY(0deg) translateX(calc(var(--cube-size) * 2)); }
        .cube.unfolded .top    { transform: rotateX(0deg) translateY(calc(var(--cube-size) * -1)); }
        .cube.unfolded .bottom { transform: rotateX(0deg) translateY(var(--cube-size)); }

        h2 { font-size: 2rem; color: white; margin-bottom: 10px; }
        p { color: #888; }
    </style>
</head>
<body>

    <div class="page-indicator" id="indicator">
        <div class="dot top"></div>
        <div class="dot page0"></div>
        <div class="dot page1"></div>
        <div class="dot page2"></div>
        <div class="dot extra"></div>
        <div class="dot bottom"></div>
    </div>

    <div class="container" id="mainContainer">
        <section class="page" id="left-page">
            <h2>About Me</h2>
            <p>기획부터 개발까지 수행하는 크리에이터입니다.</p>
        </section>

        <section class="page" id="main-page">
            <div class="hero">
                <div class="title-area">
                    <h1>작가 임동건</h1>
                    <p>몰입형 콘텐츠 - 기획부터 개발까지</p>
                    <div class="social-group">
                        <a href="http://www.instagram.com/_hsllw" target="_blank" class="social-btn"><i class="fa-brands fa-instagram"></i></a>
                        <a href="https://github.com/DongGeonLim" target="_blank" class="social-btn"><i class="fa-brands fa-github"></i></a>
                    </div>
                </div>

                <div class="scene" id="cubeScene">
                    <div class="cube" id="interactiveCube">
                        <div class="face front">click!</div>
                        <div class="face back"><span>1</span></div>
                        <div class="face right"><span>2</span></div>
                        <div class="face left"><span>3</span></div>
                        <div class="face top"><span>4</span></div>
                        <div class="face bottom"><span>5</span></div>
                    </div>
                </div>
            </div>
        </section>

        <section class="page" id="right-page">
            <h2>Extended View</h2>
            <p>큐브의 전개도가 이어진 모습입니다.</p>
        </section>
    </div>

    <script>
        const cube = document.getElementById('interactiveCube');
        const scene = document.getElementById('cubeScene');
        const container = document.getElementById('mainContainer');
        const indicator = document.getElementById('indicator');
        const dots = [document.querySelector('.page0'), document.querySelector('.page1'), document.querySelector('.page2')];

        let isUnfolded = false;
        let isDraggingCube = false;
        let isPageScrolling = false;
        let startX, startY, scrollStartX, scrollLeft;
        let currentX = -25, currentY = -15;

        const updateIndicator = () => {
            const pageIndex = Math.round(container.scrollLeft / window.innerWidth);
            dots.forEach((dot, idx) => {
                if(idx === pageIndex) dot.classList.add('active');
                else dot.classList.remove('active');
            });
        };

        // 새로고침 시 즉시 이동 보정
        window.addEventListener('load', () => {
            // scrollTo를 사용하여 애니메이션 없이 즉시 좌표 지정
            container.scrollTo({ left: window.innerWidth, behavior: 'auto' });
            updateIndicator();
            // 이후 부드러운 스크롤을 위해 behavior 활성화 가능
            setTimeout(() => { container.style.scrollBehavior = 'smooth'; }, 100);
        });

        container.addEventListener('mousedown', (e) => {
            if (!isUnfolded) return; 
            isPageScrolling = true;
            container.style.scrollSnapType = 'none'; 
            container.style.scrollBehavior = 'auto';
            scrollStartX = e.pageX - container.offsetLeft;
            scrollLeft = container.scrollLeft;
        });

        scene.addEventListener('mousedown', (e) => {
            if (isUnfolded || !e.target.classList.contains('face')) return;
            isDraggingCube = true;
            startX = e.clientX;
            startY = e.clientY;
            cube.classList.add('dragging');
        });

        window.addEventListener('mousemove', (e) => {
            if (isPageScrolling) {
                const x = e.pageX - container.offsetLeft;
                const walk = (x - scrollStartX) * 1.5;
                container.scrollLeft = scrollLeft - walk;
            }
            if (isDraggingCube) {
                const dx = e.clientX - startX;
                const dy = e.clientY - startY;
                const absY = Math.abs(currentY) % 360;
                const direction = (absY > 90 && absY < 270) ? -1 : 1;
                cube.style.transform = `rotateX(${currentY - dy * 0.5}deg) rotateY(${currentX + (dx * 0.5 * direction)}deg)`;
            }
        });

        window.addEventListener('mouseup', (e) => {
            if (isPageScrolling) {
                isPageScrolling = false;
                container.style.scrollSnapType = 'x mandatory';
                container.style.scrollBehavior = 'smooth';
                const pageIndex = Math.round(container.scrollLeft / window.innerWidth);
                container.scrollLeft = pageIndex * window.innerWidth;
            }
            if (isDraggingCube) {
                const dx = e.clientX - startX;
                const dy = e.clientY - startY;
                const absY = Math.abs(currentY) % 360;
                const direction = (absY > 90 && absY < 270) ? -1 : 1;
                currentX += dx * 0.5 * direction;
                currentY -= dy * 0.5;
                isDraggingCube = false;
                cube.classList.remove('dragging');
            }
        });

        scene.addEventListener('click', () => {
            if (isUnfolded) {
                cube.classList.remove('unfolded');
                indicator.classList.remove('active');
                container.style.overflowX = 'hidden';
                isUnfolded = false;
                setTimeout(() => {
                    currentX = -25; currentY = -15;
                    cube.style.transform = `rotateX(-15deg) rotateY(-25deg)`;
                }, 50); 
            } else {
                currentX = 0; currentY = 0;
                cube.style.transform = `rotateX(0deg) rotateY(0deg)`;
                setTimeout(() => { 
                    cube.classList.add('unfolded'); 
                    indicator.classList.add('active');
                    container.style.overflowX = 'auto';
                    isUnfolded = true; 
                }, 100);
            }
        });

        container.addEventListener('scroll', updateIndicator);
        
        // 모바일 터치 로직 개선 (연속 회전 가능)
        scene.addEventListener('touchstart', (e) => {
            if (isUnfolded || !e.target.classList.contains('face')) return;
            isDraggingCube = true;
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
            cube.classList.add('dragging');
        }, { passive: true });

        window.addEventListener('touchmove', (e) => {
            if (!isDraggingCube) return;
            const dx = e.touches[0].clientX - startX;
            const dy = e.touches[0].clientY - startY;
            const absY = Math.abs(currentY) % 360;
            const direction = (absY > 90 && absY < 270) ? -1 : 1;
            cube.style.transform = `rotateX(${currentY - dy * 0.5}deg) rotateY(${currentX + (dx * 0.5 * direction)}deg)`;
        }, { passive: true });

        window.addEventListener('touchend', (e) => {
            if (!isDraggingCube) return;
            const dx = e.changedTouches[0].clientX - startX;
            const dy = e.changedTouches[0].clientY - startY;
            const absY = Math.abs(currentY) % 360;
            const direction = (absY > 90 && absY < 270) ? -1 : 1;
            
            // 최종 각도 누적 저장 (모바일 튀는 현상 방지)
            currentX += dx * 0.5 * direction;
            currentY -= dy * 0.5;
            
            isDraggingCube = false;
            cube.classList.remove('dragging');
        });
    </script>
</body>
</html>